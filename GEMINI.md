# 프로젝트: Vocabulario Inteligente (지능형 어휘 학습)

## 1. 프로젝트 비전 및 핵심 철학 (Vision & Core Philosophy)

-   **한 줄 비전:** 언어학과 인지과학, AI를 융합하여 **'가장 효율적이고 즐거운'** 스페인어 어휘 학습 경험을 제공하는 지능형 학습 동반자.
-   **핵심 철학:** 기존 단어 암기 앱의 고질적인 문제들을 해결하는 데 집중한다.
    1.  **동기 부여의 문제 (The Motivation Problem):**
        *   **문제점:** 단순한 카드 넘기기식 암기는 지루하고, 학습자가 얼마나 성장했는지 직관적으로 알기 어렵다. 이는 학습 포기로 이어진다.
        *   **우리의 해결책:** **'지식의 피라미드'**를 통한 시각적 성취감 제공. 사용자는 5,000개의 단어로 이루어진 거대한 지식의 지도를 탐험하고, 아는 단어가 늘어날수록 자신의 영토가 넓어지는 것을 보며 게임과 같은 즐거움과 강력한 학습 동기를 얻는다.
    2.  **학습 효율성의 문제 (The Efficiency Problem):**
        *   **문제점:** 모든 단어를 동일한 비중으로 암기하는 것은 비효율적이다. 인간의 뇌는 정보를 주기적으로 복습하지 않으면 잊어버린다.
        *   **우리의 해결책:** **'과학적 간격 반복 시스템(SRS)'** 도입. 에빙하우스의 망각 곡선 이론에 기반하여, 각 단어에 대한 사용자의 숙련도를 추적하고 가장 잊어버리기 쉬운 시점에 맞춰 최적의 복습 주기를 개인별로 제공한다. 이는 최소한의 노력으로 장기 기억을 극대화한다.
    3.  **인지 부하의 문제 (The Cognitive Load Problem):**
        *   **문제점:** 단어를 문장 속에서 익히는 것이 가장 효과적이지만, 기존 예문들은 학습자가 모르는 다른 단어나 문법을 포함하는 경우가 많아 오히려 학습을 방해하고 좌절감을 준다.
        *   **우리의 해결책:** **'개인화된 AI 동적 예문'** 생성. 사용자가 **이미 학습을 완료한 단어와 아는 문법 규칙**만을 조합하여, AI(Gemini)가 즉석에서 '나만을 위한' 예문을 만들어준다. 이를 통해 어떤 인지적 장벽도 없이 목표 단어의 쓰임새에만 온전히 집중할 수 있다.

## 2. 주요 기능 상세 설계 (Detailed Feature Design)

-   **지식의 피라미드 (The Knowledge Pyramid):**
    -   **역할:** 앱의 메인 대시보드이자 시각적 동기부여 장치.
    -   **구현:**
        -   5,000개 단어를 **최초 1회 전체 다운로드(예: words.json)** 후, **IndexedDB 등 로컬 저장소에 저장**
        -   이후 모든 피라미드/학습 기능은 **로컬 데이터만 사용** (오프라인 지원)
        -   필요시 "데이터 새로고침" 기능으로 서버에서 최신 데이터 재다운로드
        -   5,000개 단어를 **빈도수 계층(예: 100개 단위)**으로 나누어 피라미드 형태로 배치
        -   **각 계층 내에서는 품사별(명사/동사/형용사/기타)로 블록을 그룹화**
        -   각 단어 블록은 학습 상태(`미학습`, `완료`, `복습필요`)에 따라 색상이 구분됨
        -   품사별로 색상/경계선/아이콘 등으로 시각적 구분
        -   (확장) 상단 필터/검색/품사별 하이라이트 등 다양한 인터랙션 제공
    -   **기술적 고려사항:**
        -   5,000개 이상의 DOM 요소 렌더링 시 발생할 수 있는 성능 문제를 해결하기 위해, 일반 `<div>` 대신 **Canvas 기반 렌더링 라이브러리(예: Konva.js)** 사용
        -   **최초 데이터 다운로드/저장, 오프라인 동기화, 데이터 새로고침** 등 로컬 데이터 관리 전략 필수
    -   **인터랙션:**
        -   Hover: 단어, 뜻, 분류코드(A-1-a 등) 툴팁 표시
        -   Click: 단어 상세/학습 모드 진입(모달)
        -   필터: "복습 필요한 단어만", "B-3만 보기" 등
-   **학습 기능 (Learning Features):**
    -   **접근법:** 학습 과정을 **'인지(Recognition) → 회상(Recall) → 생성(Production)'**의 3단계로 나누어 체계적인 모드를 제공한다.
    -   **MVP:** 가장 기본적이고 효과적인 **'클래식 플래시카드'** 모드(회상 단계)에 집중한다.
    -   **Post-MVP:** 객관식 퀴즈(인지), 단어 타이핑(회상), 빈칸 채우기(생성) 등 다양한 모드를 추가한다.
    -   **화면/라우트 구조 분리:**
        -   **피라미드(대시보드):** 진도/분포/동기부여 시각화에 집중 (예: /dashboard)
        -   **학습 메뉴(별도 화면/라우트):** 실제 학습/복습/퀴즈 등 다양한 모드 제공 (예: /learn, /learn/flashcard 등)
        -   각 메뉴는 React Router 등으로 분리, UX/기능 독립성 강화
        -   피라미드에서 “학습하기” 버튼/메뉴로 학습 메뉴 진입
        -   학습 완료/진도는 IndexedDB/user_word_progress에 반영, 피라미드에 실시간 반영
-   **동적인 예문 생성 (Dynamic Sentence Generation):**
    -   **역할:** 프로젝트의 핵심 차별점. 인지 부하 없는 문맥 학습 제공.
    -   **구현:** Supabase Edge Function을 통해 Gemini API를 호출.
    -   **프롬프트 설계:** `[목표 단어]`, `[사용자가 아는 단어 목록]`, `[고정된 문법 규칙(초기엔 현재 시제만)]`을 조합하여 최적의 예문을 생성하도록 정교한 프롬프트를 구성한다.
-   **단어 변화 연습 (Inflection Practice):**
    -   **역할:** 스페인어의 가장 큰 난관인 동사 변화와 성/수 일치 문제를 해결.
    -   **구현:** 동사 원형과 주어를 제시하고 변화형을 맞추거나, 명사와 형용사를 올바르게 조합하는 별도의 퀴즈 모드를 제공한다.

## 3. 기술 아키텍처 및 데이터 (Tech & Data)

-   **기술 스택:** React, **Supabase** (PostgreSQL, Auth, Edge Functions), Gemini API, PWA.
-   **아키텍처:** 설치 없이 즉시 사용 가능하고, 오프라인 동기화를 지원하는 **PWA(Progressive Web App)**.
    -   **오프라인 동기화:** **Service Worker**와 **IndexedDB**를 사용하여 네트워크가 없을 때의 학습 기록을 로컬에 저장한 뒤, 온라인 상태가 되면 서버와 동기화한다.
-   **데이터 소스:** `spanish2.csv` (사용자 제공)
    -   **단어 분류 코드:** `A-1-a` (영어와 완전 동일)부터 `B-3` (**거짓 친구**)까지 체계적으로 분류된 데이터를 기반으로 함.
-   **DB 스키마:**
    -   `words`: 5,000개 단어의 원본 정보 저장.
    -   `user_word_progress`: 사용자별 단어 학습 상태, 복습 주기(`next_review_at`), 숙련도(`ease_factor`) 등 SRS 관련 데이터를 저장.

## 4. 프로젝트 로드맵 (Roadmap)

-   **핵심 원칙:** 가장 본질적인 가치를 담은 **MVP(최소 기능 제품)**를 우선 개발하고, 빠르게 검증하며 점진적으로 고도화한다.

## 5. MVP 개발 계획 및 진척도

-   **Phase 1: MVP 구축 (진행률: 33%)**

    -   **[Task 1.1] 환경 및 DB 설정 (진행률: 100%)**
        -   [x] **1.1.1:** React 프로젝트에 Supabase 연동 (`supabaseClient.js` 설정)
        -   [x] **1.1.2:** Supabase 프로젝트에 `words`, `user_word_progress` 테이블 생성
        -   [x] **1.1.3:** `spanish2.csv` 데이터를 `words` 테이블에 업로드

    -   **[Task 1.2] 피라미드 UI 및 데이터 연동 (진행률: 20%)**
        -   [x] **1.2.1:** `words.json` 등 전체 단어셋 파일 준비 및 public/서버 업로드 (데이터 변환/인코딩/경로 검증 완료)
        -   [ ] **1.2.2:** 앱 최초 진입 시 단어 데이터 fetch & IndexedDB(로컬 저장) 구현
        -   [ ] **1.2.3:** Pyramid 등 모든 컴포넌트가 IndexedDB에서 데이터 읽어 렌더링하도록 변경
        -   [ ] **1.2.4:** 데이터 새로고침/업데이트 기능 추가
        -   [ ] **1.2.5:** (이후) 빈도수 계층 + 품사별 그룹화, 색상/툴팁/필터 등 시각화/인터랙션 고도화
        -   [ ] **1.2.6:** React Router 적용, 피라미드/학습 메뉴 등 화면 분리 구조 구현

    -   **[Task 1.3] 학습 모드(플래시카드 등) MVP (진행률: 0%)**
        -   [ ] **1.3.1:** `LearnMenu`/`FlashcardPage` 등 학습 메뉴/화면 신설 및 라우팅 연동
        -   [ ] **1.3.2:** 플래시카드/퀴즈 등 학습 모드별 컴포넌트 생성 및 진입점 구현
        -   [ ] **1.3.3:** 학습 결과를 user_word_progress/IndexedDB에 반영, 피라미드 진도율 실시간 연동
        -   [ ] **1.3.4:** (이후) 다양한 학습 모드/UX 고도화

    -   **[Task 1.4] SRS(간격 반복 시스템) MVP (진행률: 0%)**
        -   [ ] **1.4.1:** SRS 기본 로직(복습 우선순위, correct_streak, ease_factor 등) 구현
        -   [ ] **1.4.2:** 오늘 복습해야 할 단어만 쿼리/필터링 기능 구현
        -   [ ] **1.4.3:** 학습/복습 결과에 따라 SRS 데이터 갱신

    -   **[Task 1.5] 동적 예문 생성 MVP (진행률: 0%)**
        -   [ ] **1.5.1:** Supabase Edge Function에서 Gemini API 연동
        -   [ ] **1.5.2:** 프롬프트 설계(목표 단어, 아는 단어, 문법 수준 등)
        -   [ ] **1.5.3:** 예문/번역 결과를 학습 모달에 표시

    -   **[Task 1.6] 단어 변화 연습 MVP (진행률: 0%)**
        -   [ ] **1.6.1:** 동사 변화/성수 일치 퀴즈 모드 UI/로직 설계
        -   [ ] **1.6.2:** words 테이블에 필요한 변화 정보(동사/명사 구분 등) 확장
        -   [ ] **1.6.3:** 변화 퀴즈 결과를 학습 진척도에 반영

#### **🧠 Post-MVP (고도화 단계)**
-   품사별 세로 섹션, 진척도 Progress Bar, 동적 하이라이트 등 시각화 고도화
-   3D 피라미드(React-Three-Fiber) 등 시각화 고도화
-   문법 수준 추적 및 동적 프롬프트 고도화
-   AI 예문/퀴즈 자동 평가 및 피드백 시스템
-   PWA 기능(오프라인 동기화, 홈 화면 추가) 고도화
-   (실무 체크리스트) 대용량 데이터 변환 시 인코딩/경로/파일명/변환 스크립트 관리 주의
-   라우팅/UX 고도화, 메뉴/모드별 진입점 다양화, 모바일/반응형 최적화 등

## **단어분류기준""
✅ A그룹: 영어와 유사하여 쉽게 학습할 수 있는 단어
영어의 지식을 활용해 의미, 철자, 발음을 쉽게 유추할 수 있는 단어 그룹입니다.
 * 레벨 1: 명백한 동족어 (Obvious Cognates)
   * 1-A (완전 동일형): 철자가 완전히 같아 즉시 인식 가능한 단어.
     * 예: animal, social, hotel, control, general
   * 1-B (유사 동일형): 악센트나 한두 글자 차이로 거의 동일하게 보이는 단어.
     * 예: música (music), familia (family), número (number), posible (possible)
 * 레벨 2: 예측 가능한 패턴의 동족어 (Predictable Pattern Cognates)
   * 영어와 스페인어 사이의 일정한 철자 변환 규칙을 따르는 단어. 이 패턴을 익히면 수많은 단어를 쉽게 익힐 수 있습니다.
   * -ción → -tion: nación (nation), atención (attention)
   * -dad → -ty: ciudad (city), universidad (university)
   * -oso → -ous: famoso (famous), curioso (curious)
   * -mente → -ly: finalmente (finally), normalmente (normally)
   * es- + (s+자음): especial (special), estudiante (student)
   * -ia/-io → -y: historia (history), democracia (democracy)
   * 기타 유사 패턴: perfecto (perfect), diferente (different)
 * 레벨 3: 어근을 공유하는 동족어 (Shared Root Cognates)
   * 일상적인 영어 단어와는 바로 연결되지 않지만, 조금 더 깊은 어원(라틴어 등)을 공유하여 영어의 다른 단어와 연결하면 유추가 가능한 단어. 학습자의 어휘력에 따라 B그룹으로 느껴질 수도 있습니다.
   * 예: escribir (write) → scribe, mano (hand) → manual, pie (foot) → pedestrian, cuerpo (body) → corpse, ver (see) → vision
 * 레벨 4: 실용적 유사어 (Practical Look-alikes)
   * 정의: 어원은 다르지만, 우연히 철자나 발음이 영어 단어와 매우 흡사하여 학습에 직접적인 도움이 되는 단어.
   * 예시: día ↔ day
⛔ B그룹: 영어와 비유사하여 암기가 필요한 단어
영어 지식만으로는 의미를 유추하기 어려워 별도의 암기가 필요한 단어 그룹입니다.
 * 레벨 1: 핵심 기능어 (Function Words)
   * 문법적 기능을 하는 고빈도 단어들로, 대부분의 언어에서 고유한 형태를 가집니다.
   * 예: de (of), que (that), y (and), a (to), el/la (the), por (for), pero (but)
 * 레벨 2: 어원적 연관성이 낮은 핵심 어휘 (Unrelated Core Vocabulary)
   * 일상생활에서 매우 자주 쓰이지만, 영어와 어원이 달라 직관적 연상이 어려운 기초 단어들.
   * 예: ser/estar (to be), ir (to go), casa (house), mujer (woman), vida (life), bueno (good), agua (water), día (day)
 * ⚠️ 레벨 3: 거짓 친구 (False Friends) - 특별 주의!
   * 철자는 A그룹처럼 유사하지만 의미가 완전히 달라 학습자를 함정에 빠뜨릴 수 있는 단어들. 이 그룹은 따로 목록을 만들어 집중적으로 암기하는 것이 매우 중요합니다.
   * 예: éxito (success, not exit), sopa (soup, not soap), ropa (clothes, not rope), largo (long, not large), asistir (to attend, not to assist)

# (업데이트) 지식의 피라미드 대시보드 리뉴얼 개발 진행 상황

## 1. 전체 구조 및 UX 전략
- 5,000개 단어를 네모칸(블록)으로 시각화하는 대시보드
- **전체 뷰**: 진도 상태(미학습/완료/복습필요 등)에 따라 색상만 표시, 품사/단어 정보 없이 초고속 렌더링
- **계층 뷰**: 100개 단위로 계층화, 각 계층 내에서 품사별로 네모들이 자연스럽게 모여 있고, 빈도수 순서대로 정렬
- **단어 상세 뷰**: 계층에서 개별 단어 클릭 시 상세 정보(뜻, 품사, 예문 등) 표시
- **점진적 정보 노출**: 전체→계층→단어로 내려갈수록 더 많은 정보와 인터랙션 제공

## 2. 애니메이션 및 전환
- 전체↔계층, 계층↔전체 전환 시 부드럽고 빠른 애니메이션 필수
  - 네모들이 확대/축소, 이동, 투명도 변화 등으로 자연스럽게 전환
  - 품사별 그룹핑 시 네모들이 해당 그룹 위치로 이동하는 애니메이션
- requestAnimationFrame, react-spring, framer-motion, 혹은 Canvas/WebGL 직접 보간 활용

## 3. 성능 및 기술적 고려
- 5,000개 네모를 초고속으로 렌더링하기 위해 Canvas/WebGL 기반(react-konva 등) 사용
- 전체 뷰에서는 최소한의 정보만, 계층 뷰부터 툴팁/상세 정보 제공
- 반응형, 모바일/PC 모두 자연스러운 UX

## 4. 단계별 개발 계획 (진도율 추적용)
- [x] **1단계: 전체 뷰 초고속 네모 렌더링**
  - [x] 5,000개 단어를 진도 상태별 색상 네모로만 계층별(100개 단위)로 구분하여 표시 (Canvas, 반응형)
  - [x] 각 계층(줄) 클릭 시 계층 뷰 진입
- [x] **2단계: 계층 뷰 UX 개선**
  - [x] 계층 뷰에서 100개 단어를 그리드(격자) 형태로 배치, 품사별 색상 구분
  - [x] 모바일/PC 모두 자연스럽게 보이도록 반응형 적용
  - [x] 계층 뷰 상단에 '전체로 돌아가기' 버튼
- [ ] **3단계: UX 고도화 및 애니메이션**
  - [ ] 전체↔계층, 계층↔전체, 품사 그룹핑 등 주요 전환에 자연스럽고 빠른 애니메이션 적용
  - [ ] 계층 뷰에서 품사별 섹션 구분선/배경 등 시각적 개선
- [ ] **4단계: 단어 상세/학습 모달**
  - [ ] 계층 뷰에서 단어 클릭 시 상세 정보/학습 모달 표시
- [ ] **5단계: 추가 UX 고도화**
  - [ ] 계층별 진도율/통계, 필터/검색, 반응형, 모바일 최적화 등

---

### 다음 작업 식별
- [ ] 전체/계층 뷰 전환 및 품사별 그룹핑에 자연스러운 애니메이션 적용
- [ ] 계층 뷰에서 품사별 섹션 구분선/배경 등 시각적 개선
- [ ] 단어 클릭 시 상세 정보/학습 모달 구현
- [ ] 계층별 진도율/통계, 필터/검색 등 부가 기능 추가
- [ ] 코드 리팩토링 및 성능 최적화

(진도율 체크박스는 개발 진행에 따라 수시로 업데이트)